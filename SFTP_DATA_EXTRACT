--- Application rememdiation -- file name like block_afterpay_application_20250401_000000.csv
select 
PARTNER_ID,
APPLICATION_ID,
LOAN_ACCOUNT_NUMBER,
CUSTOMER_ID,
FIRST_NAME,
LAST_NAME,
SSN_OR_FEDID,
DATE_OF_BIRTH,
STREET_ADDRESS1,
STREET_ADDRESS2,
CITY,
STATE,
ZIPCODE_PLUS_FOUR,
ABILITY_TO_PAY_MEASUREMENT_VALUE,
ABILITY_TO_PAY_RESULT,
ACTIVE_DUTY_FLAG,
ADDRESS_DISCREPANCY_ALERT,
ADVERSE_ACTION_NOTICE_DATE,
ADVERSE_ACTION_REASON_1,
ADVERSE_ACTION_REASON_2,
ADVERSE_ACTION_REASON_3,
ADVERSE_ACTION_REASON_4,
APPLICANT_AGE_AT_TIME_OF_APPLICATION,
AMOUNT_FINANCED,
APPLICATION_DATE,
APPLICATION_DECISION_DATE,
APPLICATION_TYPE,
APPROVED_LOAN_AMOUNT_OR_INITIAL_CREDIT_LIMIT,
CAMPAIGN_NAME,
CIP_MATCH_FLAG,
CREDIT_REPORTING_AGENCY_SUPPLIER,
CREDIT_SCORE_EXCEPTION_NOTICE_DATE,
CUSTOMER_ECONSENT_FLAG,
CUSTOMER_REQUESTED_DECLINE_REASONS_FLAG,
DATE_CUSTOMER_REQUESTED_DECLINE_REASONS,
DATE_OF_BUREAU_INQUIRY,
DEBT_TO_INCOME_RATIO,
DISPOSITION_OF_APPLICATION,
EMPLOYMENT_DURATION,
FRAUD_ALERT_INITIAL,
FRAUD_ALERT_EXTENDED,
INCOME_OF_APPLICANT,
INCOME_OF_JOINT_OR_CO_APPLICANT,
INTEREST_RATE_METHOD,
NAME_OF_JOINT_OR_CO_APPLICANT,
LANGUAGE_FLAG,
LOAN_ACCEPTANCE_DATE,
MARKETING_CHANNEL,
MERCHANT,
MLA_STATUS,
MLA_STATUS_INDICATOR_METHOD,
NON_CRA_THIRD_PARTY_REASON_FOR_DECLINE,
NON_CRA_THIRD_PARTY_REASON_FOR_DECLINE2,
OFAC_SOFT_HIT,
OFAC_CHECK_DATE,
FIRM_OFFER_OF_CREDIT,
ORIGINATION_FEE,
PAYMENT_AMOUNT,
PAYMENT_FREQUENCY,
PAYMENT_TO_INCOME_RATIO,
PEND_REASON,
POC_FLAG,
PRODUCT,
PROMOTIONAL_INTEREST_RATE,
PROMOTIONAL_INTEREST_RATE_DURATION,
REQUESTED_LOAN_AMOUNT,
SAME_AS_CASH_CODE,
STANDARD_ACCOUNT_APR,
STANDARD_INTEREST_RATE,
TERM_LENGTH_IN_MONTHS,
CREDIT_SCORE_1,
CREDIT_SCORE_1_PULL_DATE,
CREDIT_SCORE_1_KEY_FACTOR_REASON_1,
CREDIT_SCORE_1_KEY_FACTOR_REASON_2,
CREDIT_SCORE_1_KEY_FACTOR_REASON_3,
CREDIT_SCORE_1_KEY_FACTOR_REASON_4,
CREDIT_SCORE_1_KEY_FACTOR_REASON_5,
CREDIT_SCORE_2,
CREDIT_SCORE_2_PULL_DATE,
CREDIT_SCORE_2_KEY_FACTOR_REASON_1,
CREDIT_SCORE_2_KEY_FACTOR_REASON_2,
CREDIT_SCORE_2_KEY_FACTOR_REASON_3,
CREDIT_SCORE_2_KEY_FACTOR_REASON_4,
CREDIT_SCORE_2_KEY_FACTOR_REASON_5,
CREDIT_SCORE_3,
CREDIT_SCORE_3_PULL_DATE,
CREDIT_SCORE_3_KEY_FACTOR_REASON_1,
CREDIT_SCORE_3_KEY_FACTOR_REASON_2,
CREDIT_SCORE_3_KEY_FACTOR_REASON_3,
CREDIT_SCORE_3_KEY_FACTOR_REASON_4,
CREDIT_SCORE_3_KEY_FACTOR_REASON_5,
FRAUD_SCORE_1,
FRAUD_SCORE_2,
FRAUD_SCORE_3,
FRAUD_SCORE_4,
FRAUD_SCORE_5,
FRAUD_SCORE_6,
FRAUD_SCORE_7,
FRAUD_SCORE_8,
FRAUD_SCORE_9,
FRAUD_SCORE_10
from cash_3pr_pii.afterpay.feb_de_applications
--where application_date = '2025-04-01'
QUALIFY ROW_NUMBER () OVER(PARTITION BY  application_id ORDER BY  report_generated_date desc) = 1






--- APPLICATIONS (Daily feed) -- file name like block_afterpay_application_20250401_000000.csv
select 
PARTNER_ID,
APPLICATION_ID,
LOAN_ACCOUNT_NUMBER,
CUSTOMER_ID,
FIRST_NAME,
LAST_NAME,
SSN_OR_FEDID,
DATE_OF_BIRTH,
STREET_ADDRESS1,
STREET_ADDRESS2,
CITY,
STATE,
ZIPCODE_PLUS_FOUR,
ABILITY_TO_PAY_MEASUREMENT_VALUE,
ABILITY_TO_PAY_RESULT,
ACTIVE_DUTY_FLAG,
ADDRESS_DISCREPANCY_ALERT,
ADVERSE_ACTION_NOTICE_DATE,
ADVERSE_ACTION_REASON_1,
ADVERSE_ACTION_REASON_2,
ADVERSE_ACTION_REASON_3,
ADVERSE_ACTION_REASON_4,
APPLICANT_AGE_AT_TIME_OF_APPLICATION,
AMOUNT_FINANCED,
APPLICATION_DATE,
APPLICATION_DECISION_DATE,
APPLICATION_TYPE,
APPROVED_LOAN_AMOUNT_OR_INITIAL_CREDIT_LIMIT,
CAMPAIGN_NAME,
CIP_MATCH_FLAG,
CREDIT_REPORTING_AGENCY_SUPPLIER,
CREDIT_SCORE_EXCEPTION_NOTICE_DATE,
CUSTOMER_ECONSENT_FLAG,
CUSTOMER_REQUESTED_DECLINE_REASONS_FLAG,
DATE_CUSTOMER_REQUESTED_DECLINE_REASONS,
DATE_OF_BUREAU_INQUIRY,
DEBT_TO_INCOME_RATIO,
DISPOSITION_OF_APPLICATION,
EMPLOYMENT_DURATION,
FRAUD_ALERT_INITIAL,
FRAUD_ALERT_EXTENDED,
INCOME_OF_APPLICANT,
INCOME_OF_JOINT_OR_CO_APPLICANT,
INTEREST_RATE_METHOD,
NAME_OF_JOINT_OR_CO_APPLICANT,
LANGUAGE_FLAG,
LOAN_ACCEPTANCE_DATE,
MARKETING_CHANNEL,
MERCHANT,
MLA_STATUS,
MLA_STATUS_INDICATOR_METHOD,
NON_CRA_THIRD_PARTY_REASON_FOR_DECLINE,
NON_CRA_THIRD_PARTY_REASON_FOR_DECLINE2,
OFAC_SOFT_HIT,
OFAC_CHECK_DATE,
FIRM_OFFER_OF_CREDIT,
ORIGINATION_FEE,
PAYMENT_AMOUNT,
PAYMENT_FREQUENCY,
PAYMENT_TO_INCOME_RATIO,
PEND_REASON,
POC_FLAG,
PRODUCT,
PROMOTIONAL_INTEREST_RATE,
PROMOTIONAL_INTEREST_RATE_DURATION,
REQUESTED_LOAN_AMOUNT,
SAME_AS_CASH_CODE,
STANDARD_ACCOUNT_APR,
STANDARD_INTEREST_RATE,
TERM_LENGTH_IN_MONTHS,
CREDIT_SCORE_1,
CREDIT_SCORE_1_PULL_DATE,
CREDIT_SCORE_1_KEY_FACTOR_REASON_1,
CREDIT_SCORE_1_KEY_FACTOR_REASON_2,
CREDIT_SCORE_1_KEY_FACTOR_REASON_3,
CREDIT_SCORE_1_KEY_FACTOR_REASON_4,
CREDIT_SCORE_1_KEY_FACTOR_REASON_5,
CREDIT_SCORE_2,
CREDIT_SCORE_2_PULL_DATE,
CREDIT_SCORE_2_KEY_FACTOR_REASON_1,
CREDIT_SCORE_2_KEY_FACTOR_REASON_2,
CREDIT_SCORE_2_KEY_FACTOR_REASON_3,
CREDIT_SCORE_2_KEY_FACTOR_REASON_4,
CREDIT_SCORE_2_KEY_FACTOR_REASON_5,
CREDIT_SCORE_3,
CREDIT_SCORE_3_PULL_DATE,
CREDIT_SCORE_3_KEY_FACTOR_REASON_1,
CREDIT_SCORE_3_KEY_FACTOR_REASON_2,
CREDIT_SCORE_3_KEY_FACTOR_REASON_3,
CREDIT_SCORE_3_KEY_FACTOR_REASON_4,
CREDIT_SCORE_3_KEY_FACTOR_REASON_5,
FRAUD_SCORE_1,
FRAUD_SCORE_2,
FRAUD_SCORE_3,
FRAUD_SCORE_4,
FRAUD_SCORE_5,
FRAUD_SCORE_6,
FRAUD_SCORE_7,
FRAUD_SCORE_8,
FRAUD_SCORE_9,
FRAUD_SCORE_10
from cash_3pr_pii.afterpay.feb_de_applications_daily


--- TRANSACTIONS (Monthly feed) -- file name like block_afterpay_transaction_20250331_000000.csv
select 
PARTNER_ID,
APPLICATION_ID,
LOAN_ACCOUNT_NUMBER,
CUSTOMER_ID,
UNIQUE_TRANSACTION_ID,
FIRST_PURCHASE_OR_CASH_ADVANCE_FLAG,
PAYMENT_METHOD,
TRANSACTION_AMOUNT,
TRANSACTION_CODE,
TRANSACTION_DATE,
TRANSACTION_DESCRIPTION,
TRANSACTION_TYPE
from app_cash_3pr.afterpay.feb_de_transactions_monthly





--- EOM file name like block_afterpay_eom_20250331_000000.csv
select 
PARTNER_ID,
APPLICATION_ID,
LOAN_ACCOUNT_NUMBER,
CUSTOMER_ID,
ACTIVE_DUTY_FLAG,
ADDRESS_CHANGE_REQUEST_FLAG,
ADDRESS_CHANGE_DATE,
APR,
ATTY_FLAG,
CHARGE_OFF_DATE,
CLOSED_DATE,
CLOSED_REASON,
CND_FLAG,
CREDIT_REPORTING_SUPPRESSED_FLAG,
DATA_SHARING_OPT_OUT_FLAG,
DATE_OF_FIRST_DELINQUENCY,
DNC_FLAG,
EARLIEST_CONTACT_ATTEMPT,
ECONSENT_FLAG,
LANGUAGE_FLAG,
LATEST_CONTACT_ATTEMPT,
LOAN_BALANCE_AT_CYCLE_DATE,
LOAN_BALANCE_AT_EOM,
MINIMUM_MONTHLY_PAYMENT_DUE,
NUMBER_OF_DAYS_PAST_DUE,
PENALTY_APR_FLAG,
PENALTY_APR_RATE,
PREAUTHORIZED_EFT_FLAG,
REPLACEMENT_CREDIT_CARD_REQUEST_FLAG,
REPORT_DATE,
SAME_AS_CASH_CODE,
STATE,
TCPA_MARKETING_CONSENT_FLAG,
TOTAL_NUM_CONTACTS,
TOTAL_FEES_ASSESSED,
TOTAL_INTEREST_ASSESSED,
TOTAL_PAYMENTS,
ZIPCODE_PLUS_FOUR
from app_cash_3pr.afterpay.feb_de_eom_monthly
